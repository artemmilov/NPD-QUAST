<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Help</title>
        <style>
            table {
                table-layout: auto;
                width: 100%;
                margin-top:50px;
                margin-bottom:50px;
                background: #0;
            }
            aside {
                font: 18px Ubuntu;
                background: #0;
                width: 250px;
                float: left;
                margin-left: 250px;
                margin-up: 200px;
            }
            header {
                color: #004200;
            }
            .main {
                font: 18px Ubuntu;
                margin-left: 500px;
                margin-top: 200px;
                width: 800px;
                background: #0;
            }
            .text {
                margin-left: 10%;
                margin-right: 10%;
                background: #0;
                color: #004200;
            }
            .p_aside {
                text-align: left;
                padding-right: 50px;
                margin-top:20px;
                margin-bottom:20px;
                margin-left: 50px;
            }
            p {
                margin-top:25px;
                margin-bottom:75px;
            }
            .p_text {
                margin-top:20px;
                margin-bottom:20px;
            }
            td {
                text-align: right;
            }
            .row_th {
                text-align: left;
                margin_left: 20%;
            }
            hr {
                margin-top:50px;
                margin-bottom:50px;
            }
            .MathJax_Display {
                text-align: left !important;
            }
            BODY {
                background: url(NPD-Quast.png) no-repeat 0px 0px, url(to_right.png) repeat-x, url(down.png) repeat;
            }
        </style>
        <script>
            MathJax = {
                chtml: { displayAlign: 'left' }
            };
        </script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async
                src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
    </head>
    <body link="#32a844" vlink="#32a844">
        <aside>
<p class="p_aside">
    <a href="total_page.html">
        Total
    </a>
</p><p class="p_aside">
                        <a href="Dereplicator/tool_page.html">
                            Dereplicator
                        </a>
                    </p><p class="p_aside">
    <a href="about_metrics_page.html">
        Help
    </a>
</p>
</aside>
        <div class="main">
            <div class="text">
                <h1 class="header">Help</h1>
                <hr>
                <h2 class="header">About NPD-Quast</h2>
                <p class="p_text">
                NPD-Quast is designed for analyzing natural peptide identificator\`s reports of the provided data and comparing them to each other.
                </p>
                <ul>
                <li> Copability: NPD-Quast is Python 3.9+ compliant </li>
                <li> Prerequisites: Apart from a working version of Python, the following non-standard libraries need to be installed: conda, numpy and matplotlib. Also you need to install RDKit if you want to run NPD-Quast whithout `npd-quast-env` activated.</li>
                <li> Disclaimer: NPD-Quast should work on all platforms, but was only tested in a Linux (Ubuntu 20.04) system.</li>
                </ul>

                <hr>
                <h2 class="header">How to instal NPD-Quast?</h2>
                <p class="p_text">
                Just clone this repository on your local machine and fill `npd_quast.ini` file. Note that you need to write location just that tools, which you want to run.
                </p>

                <hr>
                <h2 class="header">How to construct work folder?</h2>
                <p class="p_text">
                The work folder should contain subdir with challenges, subdir with reports and file with true answers. There are three examples of work folders in `sample` dir.
                </p>

                <h3 class="header">What are challenges are?</h3>
                <p class="p_text">
                Each challenge consist of database and spectra list. The tool under test makes identifications between spectra and molecules from database, corresponding to this challenge.
                </p>

                <h3 class="header">Subdir with challenges</h3>
                <p class="p_text">
                Firstly you need to make subsir for every challenge you have. In each challenge dir write the database file in format `csv` and make subdir named `spectra`. You have to make `mgf` file for every spectrum you have for this challenge and put them to the `spectra` subdir. Note each spectrum file contain only one spectrum.
                </p>

                <h3 class="header">Subdir with reports</h3>
                <p class="p_text">
                Just make empty subdir named `reports`.
                </p>

                <h3 class="header">True answers</h3>
                <p class="p_text">
                This file should be named "true.answers.txt". Each line of it corresponds to the true identification. All true identification should be written there. So if the `spectrum_name` spectrum from `challenge_name` challenge matches to the molecule with `true_answer_inchi_key` inchi key you need to write line `challenge_name'\t'spectrum_name'\t'true_answer_inchi` in this file. Note that you need only first 11 symbols from inchi key.
                </p>

                <hr>
                <h2 class="header">How to run NPD-Quast?</h2>
                <p class="p_text">
                To run NPD-Quast you firstly need to construct work folder which structure is written above. Also, you need all dependencies to be installed. We recommend you activate a `npd-quast-env.yml` environment which is located in `envs` dir. So, just run this command:
                </p>

                <code>
                    conda activate npd-quast-env
                </code>

                <h3 class="header">Running supported tool</h3>
                <p class="p_text">
                If you want to run your data by one of the supported tool (assume it\`s named `tool_name`) run such command (here we decided to name page with report `report_name`, you can name it as you want):
                </p>

                <code>
                    python npd_quast.py run_n_report tool_name report_name path_to_work_folder
                </code>

                <h3 class="header">Changing tool parameters</h3>
                <p class="p_text">
                To change tool parameters you need to copy json file with original params and change it as you need. After run this command:
                </p>

                <code>
                    python npd_quast.py run_n_report tool_name report_name path_to_work_folder --config path_to_your_configuration
                </code>

                <h3 class="header">Adding unsupported tool reports</h3>
                <p class="p_text">
                If you want to report unsupported tool you firstly need to run it on wour machine by yourself. After that make subdir `report_name` in the `reports` dir and write there `tool_answers.txt` file. It structure is similar as `true_answers.txt` structure.
                </p>

                <p class="p_text">
                Each line of it corresponds to the tool identification. All tool identification should be written there. So if the `spectrum_name` spectrum from `challenge_name` challenge matches to the molecule with `tool_answer_inchi_key` inchi key you need to write line `challenge_name'\t'spectrum_name'\t'tool_answer_inchi'\t'match_score` in this file. Note that you need only first 11 symbols from inchi key.
                </p>

                <p class="p_text">
                After that just run command:
                </p>

                <code>
                    python npd_quast.py compile_reports path_to_work_folder
                </code>

                <hr>
                <h2 class="header">Supported tools</h2>
                <ul><li>MAGMa+</li><br><li>Dereplicator</li><br><li>Dereplicator+</li><br><li>Sirius</li></ul>

            </div>
            <hr>
            <h5 class="header" align="center">NPD-Quast</h5>
        </div>
    </body>
</html>